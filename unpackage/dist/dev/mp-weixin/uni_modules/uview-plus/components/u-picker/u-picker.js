"use strict";const c=require("./props.js"),p=require("../../libs/mixin/mpMixin.js"),I=require("../../libs/mixin/mixin.js"),u=require("../../libs/function/index.js"),m=require("../../libs/function/test.js"),t=require("../../../../common/vendor.js"),C={name:"u-picker",mixins:[p.mpMixin,I.mixin,c.props],data(){return{lastIndex:[],innerIndex:[],innerColumns:[],columnIndex:0,showByClickInput:!1}},watch:{defaultIndex:{immediate:!0,deep:!0,handler(e){this.setIndexs(e,!0)}},columns:{immediate:!0,deep:!0,handler(e){this.setColumns(e)}}},emits:["close","cancel","confirm","change","update:modelValue"],computed:{inputLabel(){let e=this.innerColumns.map((s,l)=>s[this.innerIndex[l]]),n=[];return e.forEach(s=>{n.push(s[this.keyName])}),n},inputValue(){let e=this.innerColumns.map((s,l)=>s[this.innerIndex[l]]),n=[];return e.forEach(s=>{n.push(s.id)}),n}},methods:{addUnit:u.addUnit,testArray:m.test.array,getItemText(e){return m.test.object(e)?e[this.keyName]:e},closeHandler(){this.closeOnClickOverlay&&(this.hasInput&&(this.showByClickInput=!1),this.$emit("close"))},cancel(){this.hasInput&&(this.showByClickInput=!1),this.$emit("cancel")},confirm(){this.$emit("update:modelValue",this.inputValue),this.hasInput&&(this.showByClickInput=!1),this.$emit("confirm",{indexs:this.innerIndex,value:this.innerColumns.map((e,n)=>e[this.innerIndex[n]]),values:this.innerColumns})},changeHandler(e){const{value:n}=e.detail;let s=0,l=0;for(let i=0;i<n.length;i++){let o=n[i];if(o!==(this.lastIndex[i]||0)){l=i,s=o;break}}this.columnIndex=l;const r=this.innerColumns;this.setLastIndex(n),this.setIndexs(n),this.$emit("update:modelValue",this.inputValue),this.$emit("change",{value:this.innerColumns.map((i,o)=>i[n[o]]),index:s,indexs:n,values:r,columnIndex:l})},setIndexs(e,n){this.innerIndex=u.deepClone(e),n&&this.setLastIndex(e)},setLastIndex(e){this.lastIndex=u.deepClone(e)},setColumnValues(e,n){this.innerColumns.splice(e,1,n),this.setLastIndex(this.innerIndex.slice(0,e));let s=u.deepClone(this.innerIndex);for(let l=0;l<this.innerColumns.length;l++)l>this.columnIndex&&(s[l]=0);this.setIndexs(s)},getColumnValues(e){return(async()=>await u.sleep())(),this.innerColumns[e]},setColumns(e){this.innerColumns=u.deepClone(e),this.innerIndex.length===0&&(this.innerIndex=new Array(e.length).fill(0))},getIndexs(){return this.innerIndex},getValues(){return(async()=>await u.sleep())(),this.innerColumns.map((e,n)=>e[this.innerIndex[n]])}}};if(!Array){const e=t.resolveComponent("u-toolbar"),n=t.resolveComponent("u-loading-icon"),s=t.resolveComponent("u-popup");(e+n+s)()}const f=()=>"../u-toolbar/u-toolbar.js",_=()=>"../u-loading-icon/u-loading-icon.js",g=()=>"../u-popup/u-popup.js";Math||(f+_+g)();function x(e,n,s,l,r,i){return t.e({a:e.hasInput},e.hasInput?{b:t.t(i.inputLabel&&i.inputLabel.length?i.inputLabel.join("/"):e.placeholder),c:t.o(o=>r.showByClickInput=!r.showByClickInput)}:{},{d:e.showToolbar},e.showToolbar?{e:t.o(i.cancel),f:t.o(i.confirm),g:t.p({cancelColor:e.cancelColor,confirmColor:e.confirmColor,cancelText:e.cancelText,confirmText:e.confirmText,title:e.title,rightSlot:!!e.toolbarRightSlot})}:{},{h:t.f(r.innerColumns,(o,a,y)=>t.e({a:i.testArray(o)},i.testArray(o)?{b:t.f(o,(d,h,w)=>({a:t.t(i.getItemText(d)),b:h,c:h===r.innerIndex[a]?"bold":"normal"})),c:i.addUnit(e.itemHeight),d:i.addUnit(e.itemHeight)}:{},{e:a})),i:`height: ${i.addUnit(e.itemHeight)}`,j:r.innerIndex,k:e.immediateChange,l:`${i.addUnit(e.visibleItemCount*e.itemHeight)}`,m:t.o((...o)=>i.changeHandler&&i.changeHandler(...o)),n:e.loading},e.loading?{o:t.p({mode:"circle"})}:{},{p:t.o(i.closeHandler),q:t.p({show:e.show||e.hasInput&&r.showByClickInput,mode:e.popupMode})})}const b=t._export_sfc(C,[["render",x],["__scopeId","data-v-91b05052"]]);wx.createComponent(b);
