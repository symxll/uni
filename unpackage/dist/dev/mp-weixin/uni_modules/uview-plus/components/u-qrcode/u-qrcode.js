"use strict";const n=require("../../../../common/vendor.js"),l=require("./qrcode.js");let u;const d={name:"u-qrcode",props:{cid:{type:String,default:"u-qrcode-canvas"+Math.random().toString()},size:{type:Number,default:200},unit:{type:String,default:"px"},show:{type:Boolean,default:!0},val:{type:String,default:""},background:{type:String,default:"#ffffff"},foreground:{type:String,default:"#000000"},pdground:{type:String,default:"#000000"},icon:{type:String,default:""},iconSize:{type:Number,default:40},lv:{type:Number,default:3},onval:{type:Boolean,default:!0},loadMake:{type:Boolean,default:!0},usingComponents:{type:Boolean,default:!0},showLoading:{type:Boolean,default:!0},loadingText:{type:String,default:"生成中"}},emits:["result","longpress"],data(){return{loading:!1,result:"",popupShow:!1,list:[{name:"保存二维码"}],ganvas:null,context:"",canvasObj:{}}},mounted:function(){this.loadMake&&(this._empty(this.val)||setTimeout(()=>{this._makeCode()},0))},methods:{_makeCode(){let e=this;this._empty(this.val)?n.index.showToast({title:"二维码内容不能为空",icon:"none",duration:2e3}):(this.loading=!0,u=new l.QRCode({context:e,canvasId:e.cid,nvueContext:e.context,usingComponents:e.usingComponents,showLoading:!1,loadingText:e.loadingText,text:e.val,size:e.size,background:e.background,foreground:e.foreground,pdground:e.pdground,correctLevel:e.lv,image:e.icon,imageSize:e.iconSize,cbResult:function(i){e._result(i)}}))},_clearCode(){this._result(""),u.clear()},_saveCode(){let e=this;this.result!=""&&n.index.saveImageToPhotosAlbum({filePath:e.result,success:function(){n.index.showToast({title:"二维码保存成功",icon:"success",duration:2e3})}})},preview(){n.index.previewImage({urls:[this.result],longPressActions:{itemList:["保存二维码图片"],success:function(e){switch(e.tapIndex){case 0:that._saveCode();break}},fail:function(e){console.log(e.errMsg)}}})},longpress(){this.$emit("longpress",this.result)},selectClick(e){switch(e){case 0:alert("保存二维码"),this._saveCode();break}},_result(e){this.loading=!1,this.result=e,this.$emit("result",e)},_empty(e){let i=typeof e,t=!1;return i=="number"&&String(e)==""||i=="undefined"?t=!0:i=="object"?(JSON.stringify(e)=="{}"||JSON.stringify(e)=="[]"||e==null)&&(t=!0):i=="string"?(e==""||e=="undefined"||e=="null"||e=="{}"||e=="[]")&&(t=!0):i=="function"&&(t=!1),t}},watch:{size:function(e,i){e!=i&&!this._empty(e)&&(this.cSize=e,this._empty(this.val)||setTimeout(()=>{this._makeCode()},100))},val:function(e,i){this.onval&&e!=i&&!this._empty(e)&&setTimeout(()=>{this._makeCode()},0)}},computed:{}};Array||n.resolveComponent("up-loading-icon")();const r=()=>"../u-loading-icon/u-loading-icon.js";Math||r();function c(e,i,t,g,a,o){return n.e({a:t.cid,b:t.cid,c:t.size+t.unit,d:t.size+t.unit,e:t.showLoading&&a.loading},t.showLoading&&a.loading?{f:n.p({vertical:!0,text:t.loadingText,textSize:"14px"}),g:t.size+t.unit,h:t.size+t.unit}:{},{i:n.o((...s)=>o.preview&&o.preview(...s)),j:n.o((...s)=>o.longpress&&o.longpress(...s))})}const f=n._export_sfc(d,[["render",c],["__scopeId","data-v-44e78b4f"]]);wx.createComponent(f);
